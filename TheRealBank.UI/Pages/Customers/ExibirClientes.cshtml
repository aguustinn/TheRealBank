@page
@model TheRealBank.UI.Pages.Customers.ExibirClientesModel
@{
    ViewData["Title"] = "Lista de Clientes";
    Layout = "/Pages/Shared/_Layout.cshtml";
}
<style>
    /* estilos existentes mantidos */
    .promote-btn {
        font-weight: 600;
    }

    .list-container {
        background-color: white;
        padding: 40px 50px;
        border-radius: 16px;
        box-shadow: 0 15px 40px rgba(0,0,0,0.08);
        border: 1px solid #e0e8f0;
        width: 100%;
        margin-top: 40px;
        margin-bottom: 40px;
        opacity: 0;
        transform: translateY(20px);
        animation: fadeInSlideUp 0.8s ease-out forwards;
    }

    @@keyframes fadeInSlideUp {
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* Cabeçalho com Título e Botão "Novo" */
    .list-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
        border-bottom: 2px solid #f0f0f0;
        padding-bottom: 20px;
    }

    .list-header-title {
        display: flex;
        align-items: center;
    }

    .list-icon {
        font-size: 2.5rem;
        color: var(--bank-accent); /* Cor Dourada */
        margin-right: 15px;
    }

    .list-header h1 {
        color: var(--bank-dark);
        font-weight: 700;
        font-size: 2.2em;
        margin: 0;
    }

    /* Botão de Adicionar */
    .list-header .btn i {
        margin-right: 8px;
    }

    .list-header .btn {
        font-weight: 600;
        border-radius: 8px;
        padding: 10px 20px;
    }

    /* Estilo da Tabela */
    .table {
        vertical-align: middle; /* Alinha o conteúdo das células verticalmente */
    }

        /* Cabeçalho da Tabela (Thead) */
        .table thead {
            background-color: var(--bank-dark); /* Fundo escuro */
            color: white;
        }

        .table th {
            padding: 1rem;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .table td {
            padding: 1rem;
            color: #556278; /* Texto da célula */
        }

    .table-striped > tbody > tr:nth-of-type(odd) > * {
        --bs-table-accent-bg: #f9f9f9; /* Cor da linha listrada mais suave */
    }

    /* Botões de Ação na Tabela */
    .action-buttons {
        display: flex;
        gap: 10px; /* Espaço entre os botões */
    }

        .action-buttons .btn i {
            margin-right: 5px; /* Espaço entre ícone e texto */
        }
    .promote-btn { font-weight:600; }
    .demote-btn  { font-weight:600; }
    /* restante dos estilos existentes mantidos */
</style>

<div class="list-container">
    <div class="list-header">
        <div class="list-header-title">
            <i class="fa-solid fa-users list-icon"></i>
            <h1>Lista de Clientes</h1>
        </div>
        <a class="btn btn-primary" asp-page="/Customers/AddCliente">
            <i class="fa-solid fa-plus"></i> Cadastrar Novo Cliente
        </a>
    </div>

    <div class="table-responsive">
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th>Nome</th>
                    <th>CPF</th>
                    <th>Email</th>
                    <th>Saldo</th>
                    <th>Admin?</th>
                    <th>Opções</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var cliente in Model.Clientes)
                {
                    <tr>
                        <td>@cliente.Nome</td>
                        <td>@cliente.CPF</td>
                        <td>@cliente.Email</td>
                        <td>@cliente.Saldo.ToString("C")</td>
                        <td>
                            @if (cliente.Auth)
                            {
                                <span class="badge bg-success">Sim</span>
                            }
                            else
                            {
                                <span class="badge bg-secondary">Não</span>
                            }
                        </td>
                        <td>
                            <div class="action-buttons">
                                <a class="btn btn-outline-primary btn-sm" asp-page="/Customers/EditarCliente" asp-route-cpf="@cliente.CPF">
                                    <i class="fa-solid fa-pencil"></i> Editar
                                </a>
                                <a class="btn btn-outline-danger btn-sm" asp-page="/Customers/Excluir_Cliente" asp-route-cpf="@cliente.CPF">
                                    <i class="fa-solid fa-trash-can"></i> Excluir
                                </a>

                                @* Promover (se não for admin) *@
                                @if (!cliente.Auth && User.IsInRole("Admin"))
                                {
                                    <form method="post" asp-page-handler="Promote" asp-route-cpf="@cliente.CPF" class="d-inline">
                                        <button type="submit" class="btn btn-outline-warning btn-sm promote-btn">
                                            <i class="fa-solid fa-arrow-up"></i> Tornar Admin
                                        </button>
                                    </form>
                                }

                                @* Rebaixar (se for admin, outro usuário, e você é admin) *@
                                @if (cliente.Auth && User.IsInRole("Admin") && cliente.Email != User.FindFirst(System.Security.Claims.ClaimTypes.Email)?.Value)
                                {
                                    <form method="post" asp-page-handler="Demote" asp-route-cpf="@cliente.CPF" class="d-inline">
                                        <button type="submit" class="btn btn-outline-secondary btn-sm demote-btn">
                                            <i class="fa-solid fa-arrow-down"></i> Remover Admin
                                        </button>
                                    </form>
                                }
                            </div>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>